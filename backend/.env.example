# ===========================================
# Docling App Backend 환경 설정
# ===========================================
# 이 파일을 복사하여 .env 파일을 생성하세요:
# cp .env.example .env
#
# 프로덕션 배포 시 적절한 값으로 변경하세요.
# ===========================================

# Database 설정
# SQLite (개발): sqlite:///./docling.db
# PostgreSQL (프로덕션): postgresql://user:password@localhost:5432/docling_db
DATABASE_URL=sqlite:///./docling.db

# Docling Serve API 설정
# 외부 Docling Serve API 서버 주소
DOCLING_BASE_URL=http://kca-ai.kro.kr:8007

# API 정보
# FastAPI 문서에 표시될 제목과 버전
API_TITLE=Docling Parse API
API_VERSION=1.0.0

# CORS 설정
# 허용할 프론트엔드 도메인 (JSON 배열 형식)
# 프로덕션: ["https://yourdomain.com"]
ALLOWED_ORIGINS=["http://localhost:3000", "http://localhost:3001"]

# 파일 업로드 설정
# 최대 업로드 크기 (MB 단위)
MAX_UPLOAD_SIZE_MB=50

# 허용할 파일 확장자 (JSON 배열 형식)
ALLOWED_EXTENSIONS=[".pdf", ".docx", ".doc", ".pptx", ".ppt"]

# 폴링 설정
# Docling API 상태 확인 간격 (초)
POLL_INTERVAL=2

# ===========================================
# Qdrant Vector DB 설정
# ===========================================
# Qdrant 서버 URL
QDRANT_URL=http://kca-ai.kro.kr:6333

# Qdrant API Key (필요시)
# QDRANT_API_KEY=your_api_key_here

# 기본 Collection 이름
DEFAULT_COLLECTION_NAME=documents

# ===========================================
# Docling Serve 청킹 서버 설정
# ===========================================
# Docling Serve 청킹 API URL
# 기존 DOCLING_BASE_URL과 동일한 서버를 사용
DOCLING_CHUNKING_URL=http://kca-ai.kro.kr:8007

# 청킹 기본 설정
DEFAULT_CHUNK_SIZE=1000
DEFAULT_CHUNK_OVERLAP=200

# ===========================================
# BGE-M3 임베딩 서버 설정
# ===========================================
# 임베딩 서버 URL
EMBEDDING_URL=http://kca-ai.kro.kr:8083

# 임베딩 모델 이름
EMBEDDING_MODEL=bge-m3-korean

# 임베딩 벡터 차원 (BGE-M3는 1024 고정)
EMBEDDING_DIMENSION=1024

# 임베딩 API Key (필요시)
# EMBEDDING_API_KEY=your_embedding_api_key_here

# ===========================================
# LLM API 설정 (GPT-OSS-20B)
# ===========================================
# LLM 서버 URL
LLM_BASE_URL=http://kca-ai.kro.kr:8080

# LLM 모델 이름
LLM_MODEL=gpt-oss-20b

# LLM 기본 파라미터
LLM_DEFAULT_TEMPERATURE=0.7
LLM_DEFAULT_MAX_TOKENS=2000
LLM_DEFAULT_TOP_P=0.9

# ===========================================
# RAG 설정
# ===========================================
# RAG 검색 기본 설정
RAG_DEFAULT_TOP_K=5

# 최소 유사도 점수 (None이면 제한 없음)
# RAG_DEFAULT_SCORE_THRESHOLD=0.7

# 추론 수준 기본값 (low/medium/high)
RAG_DEFAULT_REASONING_LEVEL=medium

# ===========================================
# Qwen3 VL OCR 설정
# ===========================================
# Qwen3 VL API 서버 URL
QWEN3_VL_BASE_URL=http://kca-ai.kro.kr:8084

# Qwen3 VL 모델 이름
QWEN3_VL_MODEL=qwen3-vl-8b

# Qwen3 VL API 타임아웃 (초)
QWEN3_VL_TIMEOUT=120

# Qwen3 VL 최대 처리 페이지 수
QWEN3_VL_MAX_PAGES=50

# Qwen3 VL API 최대 토큰 수
QWEN3_VL_MAX_TOKENS=4096

# Qwen3 VL 온도 설정 (0.0 ~ 1.0)
QWEN3_VL_TEMPERATURE=0.1

# Qwen3 VL OCR 프롬프트 (텍스트 추출 지시)
QWEN3_VL_OCR_PROMPT="**CRITICAL OCR RULES - MUST FOLLOW STRICTLY**:

1. **PRESERVE ORIGINAL TEXT EXACTLY**: Extract all text with 100% accuracy.
   - DO NOT modify spacing (keep spaces/no-spaces exactly as shown)
   - DO NOT correct spelling or grammar
   - DO NOT standardize formatting
   - Preserve all special characters and punctuation marks exactly as they appear

2. **EXCLUDE PAGE METADATA**: Identify and exclude repetitive page elements:
   - Page numbers (usually at top/bottom corners)
   - Organization names or logos (repeated on every page)
   - Section headers that appear on multiple pages
   These should be written outside the main content area, not mixed into tables or body text.

3. **TABLE FORMAT - MANDATORY**: ALL tables MUST use Markdown table syntax with pipe delimiters.
   NEVER output tables as plain text. ALWAYS use this exact format:

   Structure:
   | Header 1 | Header 2 | Header 3 |
   | --- | --- | --- |
   | Data Cell 1 | Data Cell 2 | Data Cell 3 |
   | Data Cell 4 | Data Cell 5 | Data Cell 6 |

   CRITICAL RULES:
   - Every row starts with | and ends with |
   - Use | to separate columns
   - First row contains column headers
   - Second row is separator line with dashes (| --- | --- |)
   - Remaining rows contain data cells
   - If one cell contains multiple items (numbered lists, bullet points, or paragraphs), keep ALL items in the SAME cell separated by spaces
   - DO NOT split multi-item content into multiple rows
   - Preserve the exact number of columns from the original table

4. **HTML TAGS - LIMITED USE**:
   - ONLY use <br> tag for line breaks INSIDE table cells when necessary
   - NEVER use other HTML tags like <p>, <div>, <span>, etc.
   - Outside tables: use plain text and Markdown syntax only
   - The <br> tag splits text across multiple lines within the same cell

5. **OUTPUT FORMAT**: Pure Markdown only. NO code blocks (```).

이미지의 텍스트를 원본과 완전히 동일하게 추출하세요. 모든 표는 반드시 마크다운 표 형식으로 작성하세요. 표 안에서 줄바꿈이 필요한 경우에만 <br> 태그를 사용하세요. 어떠한 수정, 보정, 표준화도 하지 마세요."
