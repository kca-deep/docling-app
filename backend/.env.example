# ===========================================
# Docling App Backend 환경 설정
# ===========================================
# 이 파일을 복사하여 .env 파일을 생성하세요:
# cp .env.example .env
#
# 프로덕션 배포 시 적절한 값으로 변경하세요.
# ===========================================

# Database 설정
# SQLite (개발): sqlite:///./docling.db
# PostgreSQL (프로덕션): postgresql://user:password@localhost:5432/docling_db
DATABASE_URL=sqlite:///./docling.db

# Docling Serve API 설정
# 외부 Docling Serve API 서버 주소
DOCLING_BASE_URL=http://kca-ai.kro.kr:8007

# API 정보
# FastAPI 문서에 표시될 제목과 버전
API_TITLE=Docling Parse API
API_VERSION=1.0.0

# CORS 설정
# 허용할 프론트엔드 도메인 (JSON 배열 형식)
# 프로덕션: ["https://yourdomain.com"]
ALLOWED_ORIGINS=["http://localhost:3000", "http://localhost:3001"]

# 파일 업로드 설정
# 최대 업로드 크기 (MB 단위)
MAX_UPLOAD_SIZE_MB=50

# 허용할 파일 확장자 (JSON 배열 형식)
ALLOWED_EXTENSIONS=[".pdf", ".docx", ".doc", ".pptx", ".ppt"]

# 폴링 설정
# Docling API 상태 확인 간격 (초)
POLL_INTERVAL=2

# ===========================================
# Qdrant Vector DB 설정
# ===========================================
# Qdrant 서버 URL
QDRANT_URL=http://kca-ai.kro.kr:6333

# Qdrant API Key (필요시)
# QDRANT_API_KEY=your_api_key_here

# 기본 Collection 이름
DEFAULT_COLLECTION_NAME=documents

# ===========================================
# Docling Serve 청킹 서버 설정
# ===========================================
# Docling Serve 청킹 API URL
# 기존 DOCLING_BASE_URL과 동일한 서버를 사용
DOCLING_CHUNKING_URL=http://kca-ai.kro.kr:8007

# 청킹 기본 설정
DEFAULT_CHUNK_SIZE=1000
DEFAULT_CHUNK_OVERLAP=200

# ===========================================
# BGE-M3 임베딩 서버 설정
# ===========================================
# 임베딩 서버 URL
EMBEDDING_URL=http://kca-ai.kro.kr:8083

# 임베딩 모델 이름
EMBEDDING_MODEL=bge-m3-korean

# 임베딩 벡터 차원 (BGE-M3는 1024 고정)
EMBEDDING_DIMENSION=1024

# 임베딩 API Key (필요시)
# EMBEDDING_API_KEY=your_embedding_api_key_here

# ===========================================
# LLM API 설정 (GPT-OSS-20B)
# ===========================================
# LLM 서버 URL
LLM_BASE_URL=http://kca-ai.kro.kr:8080

# LLM 모델 이름
LLM_MODEL=gpt-oss-20b

# LLM 기본 파라미터
LLM_DEFAULT_TEMPERATURE=0.7
LLM_DEFAULT_MAX_TOKENS=2000
LLM_DEFAULT_TOP_P=0.9

# ===========================================
# RAG 설정
# ===========================================
# RAG 검색 기본 설정
RAG_DEFAULT_TOP_K=5

# 최소 유사도 점수 (None이면 제한 없음)
# RAG_DEFAULT_SCORE_THRESHOLD=0.7

# 추론 수준 기본값 (low/medium/high)
RAG_DEFAULT_REASONING_LEVEL=medium

# ===========================================
# BGE Reranker v2-m3 설정
# ===========================================
# Reranker API 서버 URL
RERANKER_URL=http://kca-ai.kro.kr:8006

# Reranker 모델 이름
RERANKER_MODEL=BAAI/bge-reranker-v2-m3

# Reranker API 타임아웃 (초)
RERANKER_TIMEOUT=30

# Reranking 사용 여부
USE_RERANKING=True

# Reranking 시 초기 검색 배수 (top_k × multiplier개 검색 후 재정렬)
# 예: top_k=5, multiplier=5 → 25개 검색 → 5개 선택
RERANK_TOP_K_MULTIPLIER=5

# Reranking 후 최소 관련도 점수 (0.0 ~ 1.0)
# 이 점수 미만의 문서는 필터링됨
RERANK_SCORE_THRESHOLD=0.5

# ===========================================
# Qwen3 VL OCR 설정
# ===========================================
# Qwen3 VL API 서버 URL
QWEN3_VL_BASE_URL=http://kca-ai.kro.kr:8084

# Qwen3 VL 모델 이름
QWEN3_VL_MODEL=qwen3-vl-8b

# Qwen3 VL API 타임아웃 (초)
QWEN3_VL_TIMEOUT=120

# Qwen3 VL 최대 처리 페이지 수
QWEN3_VL_MAX_PAGES=50

# Qwen3 VL API 최대 토큰 수
QWEN3_VL_MAX_TOKENS=4096

# Qwen3 VL 온도 설정 (0.0 ~ 1.0)
QWEN3_VL_TEMPERATURE=0.1

# Qwen3 VL OCR 프롬프트 (텍스트 추출 지시)
QWEN3_VL_OCR_PROMPT="**KOREAN DOCUMENT OCR - UTF-8 ENCODING REQUIRED**

CRITICAL RULES (MUST FOLLOW):

1. **ENCODING**: Output in UTF-8 encoding. Preserve ALL Korean characters exactly.
   - Korean: 한글 (Hangul), 한자 (Hanja)
   - Special brackets: 「」『』〈〉《》
   - Circle numbers: ①②③④⑤⑥⑦⑧⑨⑩
   - Legal markers: <개정 2024.7.11.> [본조신설 2020.12.14.>

2. **EXTRACT EXACTLY**: Copy text character-by-character as shown in image.
   - DO NOT modify spacing, spelling, grammar, or formatting
   - Preserve ALL punctuation and special characters exactly
   - Keep original line breaks and paragraph structure

3. **PAGE ELEMENTS**:
   - EXCLUDE: Repeated headers/footers (page numbers, organization logos like \"KCA 한국방송통신전파진흥원\")
   - INCLUDE: All body content

4. **TABLES - CONDITIONAL**:
   - IF you see a table with rows and columns in the image, THEN use markdown table syntax:
     | Column1 | Column2 |
     | --- | --- |
     | Data1 | Data2 |
   - DO NOT create tables for plain numbered lists (1., 2., 3.)
   - DO NOT create tables for non-tabular content
   - Use <br> tag ONLY for line breaks inside table cells

5. **LEGAL DOCUMENTS** (if applicable):
   - Keep article numbers: 제1조, 제2조
   - Keep parentheses titles: (목적), (적용범위)
   - Keep amendment history: <개정 2024.7.11.>

6. **OUTPUT FORMAT**:
   - Plain markdown only
   - NO code blocks (```)
   - NO examples from this prompt
   - DO NOT copy the table example above into the output

이미지의 모든 텍스트를 UTF-8 인코딩으로 정확히 추출하세요. 표가 실제로 있을 때만 마크다운 표 형식을 사용하고, 일반 목록은 원본 그대로 유지하세요. 프롬프트의 예시를 출력에 포함하지 마세요."
